2025-09-10T19:49:20.507+02:00  INFO 1 --- [pool-1-thread-1] c.n.k.f.service.KafkaListenerService     : [076f2b3c-37bc-4bcb-ab6a-29041acfc0f9] üîÑ Invoking buildDetailedProcessedFiles...
2025-09-10T19:49:20.813+02:00 ERROR 1 --- [pool-1-thread-1] c.n.k.f.service.KafkaListenerService     : [076f2b3c-37bc-4bcb-ab6a-29041acfc0f9] ‚ùå Error post-OT summary generation: Duplicate key 1141827557 (attempted merging values SummaryProcessedFile(customerId=211490951108, accountNumber=1141827557, firstName=null, lastName=null, email=null, mobileNumber=null, addressLine1=null, addressLine2=null, addressLine3=null, postalCode=null, contactNumber=null, product=null, templateCode=null, templateName=null, balance=null, creditLimit=null, interestRate=null, dueAmount=null, arrears=null, dueDate=null, idNumber=null, accountReference=null, pdfArchiveFileUrl=null, pdfArchiveStatus=null, pdfEmailFileUrl=null, pdfEmailStatus=null, pdfMobstatFileUrl=null, pdfMobstatStatus=null, printFileUrl=null, printStatus=null, statusCode=null, statusDescription=null, fullName=null, status=null, fileType=null, outputMethod=null, reason=null, linkedDeliveryType=null, linkedOutputMethod=null, archiveBlobUrl=null, archiveStatus=null, queueName=null, fileUrl=null, type=null, url=null, errorCode=null, errorMessage=null, outputType=null, errorReportEntry=null, archiveOutputType=null, blobUrl=null, overallStatus=null, method=null, fileName=null) and SummaryProcessedFile(customerId=211490951108, accountNumber=1141827557, firstName=null, lastName=null, email=null, mobileNumber=null, addressLine1=null, addressLine2=null, addressLine3=null, postalCode=null, contactNumber=null, product=null, templateCode=null, templateName=null, balance=null, creditLimit=null, interestRate=null, dueAmount=null, arrears=null, dueDate=null, idNumber=null, accountReference=null, pdfArchiveFileUrl=null, pdfArchiveStatus=null, pdfEmailFileUrl=null, pdfEmailStatus=null, pdfMobstatFileUrl=null, pdfMobstatStatus=null, printFileUrl=null, printStatus=null, statusCode=null, statusDescription=null, fullName=null, status=null, fileType=null, outputMethod=null, reason=null, linkedDeliveryType=null, linkedOutputMethod=null, archiveBlobUrl=null, archiveStatus=null, queueName=null, fileUrl=null, type=null, url=null, errorCode=null, errorMessage=null, outputType=null, errorReportEntry=null, archiveOutputType=null, blobUrl=null, overallStatus=null, method=null, fileName=null))
java.lang.IllegalStateException: Duplicate key 1141827557 (attempted merging values SummaryProcessedFile(customerId=211490951108, accountNumber=1141827557, firstName=null, lastName=null, email=null, mobileNumber=null, addressLine1=null, addressLine2=null, addressLine3=null, postalCode=null, contactNumber=null, product=null, templateCode=null, templateName=null, balance=null, creditLimit=null, interestRate=null, dueAmount=null, arrears=null, dueDate=null, idNumber=null, accountReference=null, pdfArchiveFileUrl=null, pdfArchiveStatus=null, pdfEmailFileUrl=null, pdfEmailStatus=null, pdfMobstatFileUrl=null, pdfMobstatStatus=null, printFileUrl=null, printStatus=null, statusCode=null, statusDescription=null, fullName=null, status=null, fileType=null, outputMethod=null, reason=null, linkedDeliveryType=null, linkedOutputMethod=null, archiveBlobUrl=null, archiveStatus=null, queueName=null, fileUrl=null, type=null, url=null, errorCode=null, errorMessage=null, outputType=null, errorReportEntry=null, archiveOutputType=null, blobUrl=null, overallStatus=null, method=null, fileName=null) and SummaryProcessedFile(customerId=211490951108, accountNumber=1141827557, firstName=null, lastName=null, email=null, mobileNumber=null, addressLine1=null, addressLine2=null, addressLine3=null, postalCode=null, contactNumber=null, product=null, templateCode=null, templateName=null, balance=null, creditLimit=null, interestRate=null, dueAmount=null, arrears=null, dueDate=null, idNumber=null, accountReference=null, pdfArchiveFileUrl=null, pdfArchiveStatus=null, pdfEmailFileUrl=null, pdfEmailStatus=null, pdfMobstatFileUrl=null, pdfMobstatStatus=null, printFileUrl=null, printStatus=null, statusCode=null, statusDescription=null, fullName=null, status=null, fileType=null, outputMethod=null, reason=null, linkedDeliveryType=null, linkedOutputMethod=null, archiveBlobUrl=null, archiveStatus=null, queueName=null, fileUrl=null, type=null, url=null, errorCode=null, errorMessage=null, outputType=null, errorReportEntry=null, archiveOutputType=null, blobUrl=null, overallStatus=null, method=null, fileName=null))
 at java.base/java.util.stream.Collectors.duplicateKeyException(Collectors.java:135) ~[na:na]
 at java.base/java.util.stream.Collectors.lambda$uniqKeysMapAccumulator$1(Collectors.java:182) ~[na:na]
 at java.base/java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169) ~[na:na]
 at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625) ~[na:na]
 at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]
 at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]
 at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:921) ~[na:na]
 at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:na]
 at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:682) ~[na:na]
 at com.nedbank.kafka.filemanage.service.KafkaListenerService.buildDetailedProcessedFiles(KafkaListenerService.java:649) ~[classes!/:na]
 at com.nedbank.kafka.filemanage.service.KafkaListenerService.processAfterOT(KafkaListenerService.java:338) ~[classes!/:na]
 at com.nedbank.kafka.filemanage.service.KafkaListenerService.lambda$onKafkaMessage$2(KafkaListenerService.java:206) ~[classes!/:na]
 at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
 at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
 at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
 at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
 at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
