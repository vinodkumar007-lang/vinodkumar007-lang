ETE:
https://nsnetextr01.blob.core.windows.net/nsneteextrm

DEV:
https://nsndvextr01.blob.core.windows.net/nsnakscontregecm001


2025-08-07T13:08:56.931+02:00  INFO 1 --- [       Thread-2] c.azure.identity.DefaultAzureCredential  : Azure Identity => Attempted credential EnvironmentCredential returns a token
2025-08-07T13:08:57.333+02:00  INFO 1 --- [t.azure.net/...] c.a.s.k.secrets.SecretAsyncClient        : Retrieved secret - ete-ecm-fm-account-key
2025-08-07T13:08:57.421+02:00  INFO 1 --- [ntainer#0-0-C-1] c.a.s.k.secrets.SecretAsyncClient        : Retrieving secret - ete-ecm-fm-account-name
2025-08-07T13:08:57.556+02:00  INFO 1 --- [t.azure.net/...] c.a.s.k.secrets.SecretAsyncClient        : Retrieved secret - ete-ecm-fm-account-name
2025-08-07T13:08:57.621+02:00  INFO 1 --- [ntainer#0-0-C-1] c.a.s.k.secrets.SecretAsyncClient        : Retrieving secret - ete-ecm-fm-container-name
2025-08-07T13:08:57.822+02:00  INFO 1 --- [t.azure.net/...] c.a.s.k.secrets.SecretAsyncClient        : Retrieved secret - ete-ecm-fm-container-name
2025-08-07T13:08:57.822+02:00  INFO 1 --- [ntainer#0-0-C-1] c.n.k.f.service.BlobStorageService       : ✅ Secrets fetched successfully from Key Vault.
2025-08-07T13:08:59.822+02:00 DEBUG 1 --- [ntainer#0-1-C-1] o.s.k.l.KafkaMessageListenerContainer    : Received: 0 records
2025-08-07T13:08:59.822+02:00 DEBUG 1 --- [ntainer#0-2-C-1] o.s.k.l.KafkaMessageListenerContainer    : Received: 0 records
2025-08-07T13:09:00.134+02:00 ERROR 1 --- [ntainer#0-0-C-1] c.n.k.f.service.BlobStorageService       : ❌ Download to local failed: If you are using a StorageSharedKeyCredential, and the server returned an error message that says 'Signature did not match', you can compare the string to sign with the one generated by the SDK. To log the string to sign, pass in the context key value pair 'Azure-Storage-Log-String-To-Sign': true to the appropriate method call.
If you are using a SAS token, and the server returned an error message that says 'Signature did not match', you can compare the string to sign with the one generated by the SDK. To log the string to sign, pass in the context key value pair 'Azure-Storage-Log-String-To-Sign': true to the appropriate generateSas method call.
Please remember to disable 'Azure-Storage-Log-String-To-Sign' before going to production as this string can potentially contain PII.
Status code 403, (empty body)

com.azure.storage.blob.models.BlobStorageException: If you are using a StorageSharedKeyCredential, and the server returned an error message that says 'Signature did not match', you can compare the string to sign with the one generated by the SDK. To log the string to sign, pass in the context key value pair 'Azure-Storage-Log-String-To-Sign': true to the appropriate method call.
If you are using a SAS token, and the server returned an error message that says 'Signature did not match', you can compare the string to sign with the one generated by the SDK. To log the string to sign, pass in the context key value pair 'Azure-Storage-Log-String-To-Sign': true to the appropriate generateSas method call.
Please remember to disable 'Azure-Storage-Log-String-To-Sign' before going to production as this string can potentially contain PII.
Status code 403, (empty body)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480) ~[na:na]
	at com.azure.core.http.rest.RestProxy.instantiateUnexpectedException(RestProxy.java:340) ~[azure-core-1.14.0.jar!/:na]
	at com.azure.core.http.rest.RestProxy.lambda$ensureExpectedStatus$8(RestProxy.java:401) ~[azure-core-1.14.0.jar!/:na]
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:44) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.Mono.subscribe(Mono.java:4490) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onComplete(FluxSwitchIfEmpty.java:82) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onComplete(TracingReactorSubscriber.java:49) ~[na:na]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onComplete(MonoFlatMap.java:181) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onComplete(TracingReactorSubscriber.java:49) ~[na:na]
	at reactor.core.publisher.FluxHide$SuppressFuseableSubscriber.onComplete(FluxHide.java:147) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.Operators$MonoSubscriber.onComplete(Operators.java:1844) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoCallable.subscribe(MonoCallable.java:59) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:122) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onNext(FluxOnErrorResume.java:79) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1802) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapInner.onNext(MonoFlatMap.java:249) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2363) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapInner.onSubscribe(MonoFlatMap.java:238) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxDelaySubscription$DelaySubscriptionMainSubscriber.onNext(FluxDelaySubscription.java:189) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.SerializedSubscriber.onNext(SerializedSubscriber.java:99) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.SerializedSubscriber.onNext(SerializedSubscriber.java:99) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.onNext(FluxTimeout.java:180) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onNext(FluxMapFuseable.java:129) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxHide$SuppressFuseableSubscriber.onNext(FluxHide.java:137) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onNext(FluxMapFuseable.java:129) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.FluxHide$SuppressFuseableSubscriber.onNext(FluxHide.java:137) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1802) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapInner.onNext(MonoFlatMap.java:249) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2363) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapInner.onSubscribe(MonoFlatMap.java:238) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.lambda$onNext$0(TracingReactorSubscriber.java:38) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.withActivePath(TracingReactorSubscriber.java:64) ~[na:na]
	at com.dynatrace.agent.introspection.reactor3.TracingReactorSubscriber.onNext(TracingReactorSubscriber.java:38) ~[na:na]
	at reactor.core.publisher.MonoCreate$DefaultMonoSink.success(MonoCreate.java:172) ~[reactor-core-3.4.25.jar!/:3.4.25]
	at com.azure.core.http.okhttp.OkHttpAsyncHttpClient$OkHttpCallback.onResponse(OkHttpAsyncHttpClient.java:196) ~[azure-core-http-okhttp-1.4.0.jar!/:na]
	at okhttp3.internal.connection.RealCall$AsyncCall.run(RealCall.kt:519) ~[okhttp-4.10.0.jar!/:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:99) ~[reactor-core-3.4.25.jar!/:3.4.25]
		at reactor.core.publisher.Mono.block(Mono.java:1742) ~[reactor-core-3.4.25.jar!/:3.4.25]
		at com.azure.storage.common.implementation.StorageImplUtils.blockWithOptionalTimeout(StorageImplUtils.java:131) ~[azure-storage-common-12.10.0.jar!/:na]
		at com.azure.storage.blob.specialized.BlobClientBase.existsWithResponse(BlobClientBase.java:308) ~[azure-storage-blob-12.10.0.jar!/:na]
		at com.azure.storage.blob.specialized.BlobClientBase.exists(BlobClientBase.java:291) ~[azure-storage-blob-12.10.0.jar!/:na]
		at com.nedbank.kafka.filemanage.service.BlobStorageService.downloadFileToLocal(BlobStorageService.java:269) ~[classes!/:na]
		at com.nedbank.kafka.filemanage.service.KafkaListenerService.onKafkaMessage(KafkaListenerService.java:158) ~[classes!/:na]
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
		at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
		at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-6.0.2.jar!/:6.0.2]
		at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-6.0.2.jar!/:6.0.2]
		at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:375) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2873) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2854) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$57(KafkaMessageListenerContainer.java:2772) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at io.micrometer.observation.Observation.observe(Observation.java:559) ~[micrometer-observation-1.10.2.jar!/:1.10.2]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2770) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2622) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2508) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2150) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1505) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1469) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1344) ~[spring-kafka-3.0.11.jar!/:3.0.11]
		at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[na:na]
		... 1 common frames omitted

2025-08-07T13:09:00.233+02:00 ERROR 1 --- [ntainer#0-0-C-1] c.n.k.f.service.KafkaListenerService     : ❌ [batchId: ed6ab0af-1738-48bf-a5cc-6a63bee5f583] Failed to download or overwrite file: https://nsndvextr01.blob.core.windows.net/nsnakscontregecm001/NDDSST_250723.DAT - Download failed

com.nedbank.kafka.filemanage.exception.CustomAppException: Download failed
